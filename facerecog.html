<!DOCTYPE html>
<html lang="english" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>A simple python script to detect and count faces in an image using python's opencv - An Average Joe</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://akshaysin.github.io/facerecog.html">

        <meta name="author" content="Akshay Sinha" />
        <meta name="keywords" content="Python,Image Recognition" />
        <meta name="description" content="A simple python script to detect and count faces in an image using python&#39;s opencv" />

        <meta property="og:site_name" content="An Average Joe" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="A simple python script to detect and count faces in an image using python&#39;s opencv"/>
        <meta property="og:url" content="https://akshaysin.github.io/facerecog.html"/>
        <meta property="og:description" content="A simple python script to detect and count faces in an image using python&#39;s opencv"/>
        <meta property="article:published_time" content="2018-07-18" />
            <meta property="article:section" content="Data Analytics" />
            <meta property="article:tag" content="Python" />
            <meta property="article:tag" content="Image Recognition" />
            <meta property="article:author" content="Akshay Sinha" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://akshaysin.github.io/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://akshaysin.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://akshaysin.github.io/theme/css/pygments/solarizeddark.css" rel="stylesheet">
    <link rel="stylesheet" href="https://akshaysin.github.io/theme/css/style.css" type="text/css"/>





    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-2905595188512795",
    enable_page_level_ads: true
  });
</script>

</head>
<body>

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://akshaysin.github.io/" class="navbar-brand">
An Average Joe            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li class="active">
                            <a href="https://akshaysin.github.io/category/data-analytics.html">Data analytics</a>
                        </li>
                        <li >
                            <a href="https://akshaysin.github.io/category/devops.html">Devops</a>
                        </li>
                        <li >
                            <a href="https://akshaysin.github.io/category/linux-hacks.html">Linux hacks</a>
                        </li>
                        <li >
                            <a href="https://akshaysin.github.io/category/python.html">Python</a>
                        </li>
                        <li >
                            <a href="https://akshaysin.github.io/category/various.html">Various</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://akshaysin.github.io/facerecog.html"
                       rel="bookmark"
                       title="Permalink to A simple python script to detect and count faces in an image using python's opencv">
                        A simple python script to detect and count faces in an image using python's opencv
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2018-07-18T20:15:00-05:00"> Wed 18 July 2018</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://akshaysin.github.io/tag/python.html">Python</a>
        /
	<a href="https://akshaysin.github.io/tag/image-recognition.html">Image Recognition</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h2>A simple python script to detect and count faces in an image using python's opencv</h2>
<p><strong><a href="">Github Link</a></strong></p>
<p>In the <a href="./2018_06_30_pedestrian_count.md">last blog</a> we talked about how to use Python's OpenCV module to detect and count the number of pedestrians in an image. Now using basically the same script lets see how to detect and count number of faces in an image. The only thing that changes between these two scripts is the haar_cascade model that we use to predict the object. Earliar we were using the model trained for full body detection. This time we will use the model to predict the facial patterns and when a match is found, tag it.</p>
<h3>Steps</h3>
<ul>
<li>Install <a href="https://docs.opencv.org/3.0-beta/doc/py_tutorials/py_setup/py_setup_in_windows/py_setup_in_windows.html">openCV</a></li>
<li>Place the image to be analyzed in root directory of the project. (In this case I use group.jpeg)</li>
<li>Execute following comand from root of the directory : <code>python face_detect_cv3.py group.jpeg</code></li>
<li>
<p>It takes a few seconds for it to run, you should following output if running against <code>group.jpeg</code> image.</p>
<p>$ python face_detect_cv3.py group.jpg
  Found 11 faces!
  Image written to file-system :  True
  [ INFO:0] Initialize OpenCL runtime...</p>
</li>
<li>
<p>If all goes good, you should see a <code>saved.jpeg</code> in the root directory. That is the analyzed image.</p>
</li>
</ul>
<h3>Result</h3>
<p>Here is a before and after snapshot of the image after the script was executed on the image. Note how it left out three faces. We need better classifier in that base.</p>
<p><img alt="Before" src="../images/the_party.jpg" /></p>
<p><img alt="After" src="../images/saved.jpg" /></p>
<h3>Actual Code</h3>
<p>As can be seen below, it only takes a little over 30 lines in total to get this working. I am using openCV library for this task.</p>
<pre><code>  import cv2
  import sys

  # Get user supplied values
  imagePath = sys.argv[1]
  cascPath = "haarcascade_frontalface_default.xml"

  # Create the haar cascade
  faceCascade = cv2.CascadeClassifier(cascPath)

  # Read the image
  image = cv2.imread(imagePath)
  gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)

  # Detect faces in the image
  faces = faceCascade.detectMultiScale(
      gray,
      scaleFactor=1.1,
      minNeighbors=5,
      minSize=(30, 30)
      #flags = cv2.CV_HAAR_SCALE_IMAGE
  )

  print("Found {0} faces!".format(len(faces)))

  # Draw a rectangle around the faces
  for (x, y, w, h) in faces:
      cv2.rectangle(image, (x, y), (x+w, y+h), (0, 255, 0), 2)

  # cv2.imshow("Faces found", image)
  status = cv2.imwrite('saved.jpg', image)
  print ("Image written to file-system : ",status)
  # cv2.waitKey(0)
</code></pre>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'an-average-joe'; // required: replace example with your forum shortname

                    var disqus_identifier = 'facerecog';
                var disqus_url = 'https://akshaysin.github.io/facerecog.html';

            var disqus_config = function () {
                this.language = "english";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="100%" class="img-thumbnail" src="https://akshaysin.github.io/images/akshay.jpg"/>
        </p>
    <p>
      <strong>About Akshay Sinha</strong><br/>
        A confused coder.
    </p>
</div><!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://www.linkedin.com/in/akshay-sinha-91215954"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
    <li class="list-group-item"><a href="https://github.com/akshaysin"><i class="fa fa-github-square fa-lg"></i> github</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="https://uptowork.com/mycv/akshaysinha" target="_blank">Resume</a>
    </li>
    <li class="list-group-item">
      <a href="https://spamty.eu/mail/v4/830/2RWUyWci8Q2f55cff1/" target="_blank">Email</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->

<!-- Sidebar/Archive -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Archive</span></h4>
  <ul class="list-group" id="archive">
        <li class="list-group-item">
          <a href="https://akshaysin.github.io/posts/2018/Sep/index.html"><i class="fa fa-calendar fa-lg"></i>September 2018 (1)
          </a>
        </li>
        <li class="list-group-item">
          <a href="https://akshaysin.github.io/posts/2018/Aug/index.html"><i class="fa fa-calendar fa-lg"></i>August 2018 (5)
          </a>
        </li>
        <li class="list-group-item">
          <a href="https://akshaysin.github.io/posts/2018/Jul/index.html"><i class="fa fa-calendar fa-lg"></i>July 2018 (2)
          </a>
        </li>
        <li class="list-group-item">
          <a href="https://akshaysin.github.io/posts/2018/Jun/index.html"><i class="fa fa-calendar fa-lg"></i>June 2018 (4)
          </a>
        </li>
        <li class="list-group-item">
          <a href="https://akshaysin.github.io/posts/2018/May/index.html"><i class="fa fa-calendar fa-lg"></i>May 2018 (1)
          </a>
        </li>
        <li class="list-group-item">
          <a href="https://akshaysin.github.io/posts/2018/Apr/index.html"><i class="fa fa-calendar fa-lg"></i>April 2018 (8)
          </a>
        </li>
        <li class="list-group-item">
          <a href="https://akshaysin.github.io/posts/2018/Mar/index.html"><i class="fa fa-calendar fa-lg"></i>March 2018 (5)
          </a>
        </li>
  </ul>
</li>
<!-- End Sidebar/Archive -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Akshay Sinha
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://akshaysin.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://akshaysin.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://akshaysin.github.io/theme/js/respond.min.js"></script>


    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'an-average-joe'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics Universal -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-118879797-1', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- End Google Analytics Universal Code -->


        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5adbce4fc80f08db"></script>
    <script>
           $(document).ready(function () {
              $("table").attr("class","table table-condensed table-bordered");
           });
    </script>
</body>
</html>